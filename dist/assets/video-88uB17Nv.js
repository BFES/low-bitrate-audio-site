import{F as g}from"./types-KFQB6SzD.js";const p=e=>new Promise((o,n)=>{const a=new FileReader;a.onload=()=>{const{result:t}=a;t instanceof ArrayBuffer?o(new Uint8Array(t)):o(new Uint8Array)},a.onerror=t=>{var i,r;n(Error(`File could not be read! Code=${((r=(i=t==null?void 0:t.target)==null?void 0:i.error)==null?void 0:r.code)||-1}`))},a.readAsArrayBuffer(e)}),w=async e=>{let o;if(typeof e=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?o=atob(e.split(",")[1]).split("").map(n=>n.charCodeAt(0)):o=await(await fetch(e)).arrayBuffer();else if(e instanceof URL)o=await(await fetch(e)).arrayBuffer();else if(e instanceof File||e instanceof Blob)o=await p(e);else return new Uint8Array;return new Uint8Array(o)};document.getElementById("toHome").addEventListener("click",()=>{window.location.href="index.html"});document.getElementById("toVideoMaker").addEventListener("click",()=>{window.location.href="video.html"});function y(e){return new Promise((o,n)=>{const a=new Image;a.onload=()=>{let t=Math.min(a.width,1920),i=Math.min(a.height,1080);t%2!==0&&t--,i%2!==0&&i--;const r=document.createElement("canvas");r.width=t,r.height=i,r.getContext("2d").drawImage(a,0,0,t,i),r.toBlob(s=>{o(s)},"image/png")},a.onerror=t=>n(t),a.src=URL.createObjectURL(e)})}const l=new g({log:!0,corePath:"/node_modules/@ffmpeg/core-mt/dist/ffmpeg-core.js"}),d=document.getElementById("status"),h=async()=>{d.textContent="Loading FFmpeg...",await l.load(),d.textContent="Ready!"};h();document.getElementById("combineBtn").addEventListener("click",async()=>{const e=document.getElementById("audioUploader"),o=document.getElementById("imageUploader"),n=document.querySelector(".download-link");if(e.files.length===0){alert("Please select an audio file.");return}const a=e.files[0];if(!a.type.startsWith("audio/")){alert("Please upload a valid audio file!"),e.value="";return}if(o.files.length===0){alert("Please select an image file.");return}const t=o.files[0];if(!t.type.startsWith("image/")){alert("Please upload a valid image file!"),o.value="";return}d.textContent="Combining...",await(await fetch(URL.createObjectURL(a))).arrayBuffer(),await l.writeFile("audio.mp3",await w(a));const m=await(await y(t)).arrayBuffer();await l.writeFile("image.png",new Uint8Array(m)),l.on("log",({message:c})=>{console.log("FFmpeg log:",c)}),await l.exec(["-loop","1","-i","image.png","-i","audio.mp3","-c:v","libx264","-tune","stillimage","-c:a","aac","-b:a","8k","-pix_fmt","yuv420p","-threads","4","-shortest","output.mp4"]),l.on("progress",({progress:c})=>{console.log(`Progress: ${(c*100).toFixed(2)}%`)});const s=await l.readFile("output.mp4"),u=new Blob([s.buffer],{type:"video/mp4"}),f=URL.createObjectURL(u);n.href=f,n.download="output.mp4",n.textContent="Download Your Video!",d.textContent="Done!"});
