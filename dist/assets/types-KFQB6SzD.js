var N=Object.defineProperty;var m=r=>{throw TypeError(r)};var _=(r,e,t)=>e in r?N(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var n=(r,e,t)=>_(r,typeof e!="symbol"?e+"":e,t),p=(r,e,t)=>e.has(r)||m("Cannot "+t);var i=(r,e,t)=>(p(r,e,"read from private field"),t?t.call(r):e.get(r)),R=(r,e,t)=>e.has(r)?m("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),D=(r,e,t,s)=>(p(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const E of document.querySelectorAll('link[rel="modulepreload"]'))s(E);new MutationObserver(E=>{for(const d of E)if(d.type==="childList")for(const O of d.addedNodes)O.tagName==="LINK"&&O.rel==="modulepreload"&&s(O)}).observe(document,{childList:!0,subtree:!0});function t(E){const d={};return E.integrity&&(d.integrity=E.integrity),E.referrerPolicy&&(d.referrerPolicy=E.referrerPolicy),E.crossOrigin==="use-credentials"?d.credentials="include":E.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(E){if(E.ep)return;E.ep=!0;const d=t(E);fetch(E.href,d)}})();var o;(function(r){r.LOAD="LOAD",r.EXEC="EXEC",r.FFPROBE="FFPROBE",r.WRITE_FILE="WRITE_FILE",r.READ_FILE="READ_FILE",r.DELETE_FILE="DELETE_FILE",r.RENAME="RENAME",r.CREATE_DIR="CREATE_DIR",r.LIST_DIR="LIST_DIR",r.DELETE_DIR="DELETE_DIR",r.ERROR="ERROR",r.DOWNLOAD="DOWNLOAD",r.PROGRESS="PROGRESS",r.LOG="LOG",r.MOUNT="MOUNT",r.UNMOUNT="UNMOUNT"})(o||(o={}));const S=(()=>{let r=0;return()=>r++})(),b=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),w=new Error("called FFmpeg.terminate()");var c,l,f,u,h,I,a;class U{constructor(){R(this,c,null);R(this,l,{});R(this,f,{});R(this,u,[]);R(this,h,[]);n(this,"loaded",!1);R(this,I,()=>{i(this,c)&&(i(this,c).onmessage=({data:{id:e,type:t,data:s}})=>{switch(t){case o.LOAD:this.loaded=!0,i(this,l)[e](s);break;case o.MOUNT:case o.UNMOUNT:case o.EXEC:case o.FFPROBE:case o.WRITE_FILE:case o.READ_FILE:case o.DELETE_FILE:case o.RENAME:case o.CREATE_DIR:case o.LIST_DIR:case o.DELETE_DIR:i(this,l)[e](s);break;case o.LOG:i(this,u).forEach(E=>E(s));break;case o.PROGRESS:i(this,h).forEach(E=>E(s));break;case o.ERROR:i(this,f)[e](s);break}delete i(this,l)[e],delete i(this,f)[e]})});R(this,a,({type:e,data:t},s=[],E)=>i(this,c)?new Promise((d,O)=>{const L=S();i(this,c)&&i(this,c).postMessage({id:L,type:e,data:t},s),i(this,l)[L]=d,i(this,f)[L]=O,E==null||E.addEventListener("abort",()=>{O(new DOMException(`Message # ${L} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(b));n(this,"load",({classWorkerURL:e,...t}={},{signal:s}={})=>(i(this,c)||(D(this,c,e?new Worker(new URL(e,import.meta.url),{type:"module"}):new Worker(new URL("/assets/worker-BAOIWoxA.js",import.meta.url),{type:"module"})),i(this,I).call(this)),i(this,a).call(this,{type:o.LOAD,data:t},void 0,s)));n(this,"exec",(e,t=-1,{signal:s}={})=>i(this,a).call(this,{type:o.EXEC,data:{args:e,timeout:t}},void 0,s));n(this,"ffprobe",(e,t=-1,{signal:s}={})=>i(this,a).call(this,{type:o.FFPROBE,data:{args:e,timeout:t}},void 0,s));n(this,"terminate",()=>{const e=Object.keys(i(this,f));for(const t of e)i(this,f)[t](w),delete i(this,f)[t],delete i(this,l)[t];i(this,c)&&(i(this,c).terminate(),D(this,c,null),this.loaded=!1)});n(this,"writeFile",(e,t,{signal:s}={})=>{const E=[];return t instanceof Uint8Array&&E.push(t.buffer),i(this,a).call(this,{type:o.WRITE_FILE,data:{path:e,data:t}},E,s)});n(this,"mount",(e,t,s)=>{const E=[];return i(this,a).call(this,{type:o.MOUNT,data:{fsType:e,options:t,mountPoint:s}},E)});n(this,"unmount",e=>{const t=[];return i(this,a).call(this,{type:o.UNMOUNT,data:{mountPoint:e}},t)});n(this,"readFile",(e,t="binary",{signal:s}={})=>i(this,a).call(this,{type:o.READ_FILE,data:{path:e,encoding:t}},void 0,s));n(this,"deleteFile",(e,{signal:t}={})=>i(this,a).call(this,{type:o.DELETE_FILE,data:{path:e}},void 0,t));n(this,"rename",(e,t,{signal:s}={})=>i(this,a).call(this,{type:o.RENAME,data:{oldPath:e,newPath:t}},void 0,s));n(this,"createDir",(e,{signal:t}={})=>i(this,a).call(this,{type:o.CREATE_DIR,data:{path:e}},void 0,t));n(this,"listDir",(e,{signal:t}={})=>i(this,a).call(this,{type:o.LIST_DIR,data:{path:e}},void 0,t));n(this,"deleteDir",(e,{signal:t}={})=>i(this,a).call(this,{type:o.DELETE_DIR,data:{path:e}},void 0,t))}on(e,t){e==="log"?i(this,u).push(t):e==="progress"&&i(this,h).push(t)}off(e,t){e==="log"?D(this,u,i(this,u).filter(s=>s!==t)):e==="progress"&&D(this,h,i(this,h).filter(s=>s!==t))}}c=new WeakMap,l=new WeakMap,f=new WeakMap,u=new WeakMap,h=new WeakMap,I=new WeakMap,a=new WeakMap;var A;(function(r){r.MEMFS="MEMFS",r.NODEFS="NODEFS",r.NODERAWFS="NODERAWFS",r.IDBFS="IDBFS",r.WORKERFS="WORKERFS",r.PROXYFS="PROXYFS"})(A||(A={}));export{U as F};
