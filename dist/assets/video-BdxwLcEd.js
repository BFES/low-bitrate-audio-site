import{F as m}from"./types-KFQB6SzD.js";const f=e=>new Promise((a,i)=>{const o=new FileReader;o.onload=()=>{const{result:t}=o;t instanceof ArrayBuffer?a(new Uint8Array(t)):a(new Uint8Array)},o.onerror=t=>{var n,r;i(Error(`File could not be read! Code=${((r=(n=t==null?void 0:t.target)==null?void 0:n.error)==null?void 0:r.code)||-1}`))},o.readAsArrayBuffer(e)}),g=async e=>{let a;if(typeof e=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?a=atob(e.split(",")[1]).split("").map(i=>i.charCodeAt(0)):a=await(await fetch(e)).arrayBuffer();else if(e instanceof URL)a=await(await fetch(e)).arrayBuffer();else if(e instanceof File||e instanceof Blob)a=await f(e);else return new Uint8Array;return new Uint8Array(a)};document.getElementById("toHome").addEventListener("click",()=>{window.location.href="index.html"});document.getElementById("toVideoMaker").addEventListener("click",()=>{window.location.href="video.html"});const l=new m({log:!0,corePath:"/node_modules/@ffmpeg/core-mt/dist/ffmpeg-core.js"}),s=document.getElementById("status"),u=async()=>{s.textContent="Loading FFmpeg...",await l.load(),s.textContent="Ready!"};u();function w(e){return new Promise((a,i)=>{const o=new Image;o.onload=()=>{let t=Math.min(o.width,1920),n=Math.min(o.height,1080);t%2!==0&&t--,n%2!==0&&n--;const r=document.createElement("canvas");r.width=t,r.height=n,r.getContext("2d").drawImage(o,0,0,t,n),r.toBlob(c=>{a(c)},"image/png")},o.onerror=t=>i(t),o.src=URL.createObjectURL(e)})}async function p(e,a,i="output.mp4"){const o=e.type==="image/gif";if(await l.writeFile("audio.mp3",new Uint8Array(await a.arrayBuffer())),o)await l.writeFile("input.gif",await g(e)),l.on("log",({message:n})=>{console.log("FFmpeg log:",n)}),await l.exec(["-stream_loop","-1","-i","input.gif","-i","audio.mp3","-c:v","libx264","-preset","veryfast","-crf","28","-c:a","aac","-b:a","8k","-pix_fmt","yuv420p","-shortest","-movflags","faststart",i]),await l.exec(["-i","video.mp4","-i","audio.mp3","-c:v","copy","-c:a","aac","-b:a","8k","-shortest","-movflags","faststart",i]);else{const r=await(await w(e)).arrayBuffer();await l.writeFile("image.png",new Uint8Array(r)),l.on("log",({message:d})=>{console.log("FFmpeg log:",d)}),await l.exec(["-loop","1","-i","image.png","-i","audio.mp3","-c:v","libx264","-tune","stillimage","-c:a","aac","-b:a","8k","-pix_fmt","yuv420p","-threads","4","-shortest",i])}const t=await l.readFile(i);return new Blob([t.buffer],{type:"video/mp4"})}document.getElementById("combineBtn").addEventListener("click",async()=>{const e=document.getElementById("audioUploader"),a=document.getElementById("imageUploader"),i=document.querySelector(".download-link");if(e.files.length===0){alert("Please select an audio file.");return}const o=e.files[0];if(!o.type.startsWith("audio/")){alert("Please upload a valid audio file!"),e.value="";return}if(a.files.length===0){alert("Please select an image file.");return}const t=a.files[0];if(!t.type.startsWith("image/")){alert("Please upload a valid image file!"),a.value="";return}s.textContent="Combining...";const n=await p(t,o),r=URL.createObjectURL(n);i.href=r,i.download="output.mp4",i.textContent="Download Your Video!",s.textContent="Done!"});
