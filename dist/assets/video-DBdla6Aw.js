import"./style-BnZmgMJw.js";import{F as m}from"./types-D-QKHKUd.js";const f=e=>new Promise((a,o)=>{const n=new FileReader;n.onload=()=>{const{result:t}=n;t instanceof ArrayBuffer?a(new Uint8Array(t)):a(new Uint8Array)},n.onerror=t=>{var i,r;o(Error(`File could not be read! Code=${((r=(i=t==null?void 0:t.target)==null?void 0:i.error)==null?void 0:r.code)||-1}`))},n.readAsArrayBuffer(e)}),g=async e=>{let a;if(typeof e=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?a=atob(e.split(",")[1]).split("").map(o=>o.charCodeAt(0)):a=await(await fetch(e)).arrayBuffer();else if(e instanceof URL)a=await(await fetch(e)).arrayBuffer();else if(e instanceof File||e instanceof Blob)a=await f(e);else return new Uint8Array;return new Uint8Array(a)};document.getElementById("toHome").addEventListener("click",()=>{window.location.href="index.html"});document.getElementById("toVideoMaker").addEventListener("click",()=>{window.location.href="video.html"});document.getElementById("toChangelog").addEventListener("click",()=>{window.location.href="changelog.html"});document.getElementById("toImageTool").addEventListener("click",()=>{window.location.href="image.html"});document.getElementById("togglePrivacy").addEventListener("click",()=>{document.getElementById("privacyContent").classList.toggle("open")});const s=new m({log:!0,corePath:"/node_modules/@ffmpeg/core-mt/dist/ffmpeg-core.js"}),l=document.getElementById("status"),u=async()=>{l.textContent="Loading FFmpeg...",await s.load(),l.textContent="Ready!"};u();function p(e){return new Promise((a,o)=>{const n=new Image;n.onload=()=>{let t=Math.min(n.width,1920),i=Math.min(n.height,1080);t%2!==0&&t--,i%2!==0&&i--;const r=document.createElement("canvas");r.width=t,r.height=i,r.getContext("2d").drawImage(n,0,0,t,i),r.toBlob(c=>{a(c)},"image/png")},n.onerror=t=>o(t),n.src=URL.createObjectURL(e)})}async function w(e,a,o="output.mp4"){const n=e.type==="image/gif";if(await s.writeFile("audio.mp3",new Uint8Array(await a.arrayBuffer())),n)await s.writeFile("input.gif",await g(e)),l.textContent="Converting GIF to mp4...",await s.exec(["-stream_loop","-1","-i","input.gif","-i","audio.mp3","-c:v","libx264","-preset","veryfast","-crf","28","-c:a","aac","-b:a","8k","-pix_fmt","yuv420p","-shortest","-movflags","faststart",o]),s.on("progress",({progress:i})=>{l.textContent=`Progress: ${(i*100).toFixed(0)}%`}),await s.exec(["-i","video.mp4","-i","audio.mp3","-c:v","copy","-c:a","aac","-b:a","8k","-shortest","-movflags","faststart",o]);else{const r=await(await p(e)).arrayBuffer();await s.writeFile("image.png",new Uint8Array(r)),s.on("progress",({progress:d})=>{l.textContent=`Progress: ${(d*100).toFixed(0)}%`}),await s.exec(["-loop","1","-i","image.png","-i","audio.mp3","-c:v","libx264","-tune","stillimage","-c:a","aac","-b:a","8k","-pix_fmt","yuv420p","-threads","4","-shortest",o])}const t=await s.readFile(o);return new Blob([t.buffer],{type:"video/mp4"})}document.getElementById("combineBtn").addEventListener("click",async()=>{const e=document.getElementById("audioUploader"),a=document.getElementById("imageUploader"),o=document.querySelector(".download-link");if(o.href="",o.textContent="",e.files.length===0){alert("Please select an audio file.");return}const n=e.files[0];if(!n.type.startsWith("audio/")){alert("Please upload a valid audio file!"),e.value="";return}if(a.files.length===0){alert("Please select an image file.");return}const t=a.files[0];if(!t.type.startsWith("image/")){alert("Please upload a valid image file!"),a.value="";return}l.textContent="Combining...";const i=await w(t,n),r=URL.createObjectURL(i);o.href=r,o.download="output.mp4",o.textContent="Download Your Video!",l.textContent="Done!",s.off("progress")});
