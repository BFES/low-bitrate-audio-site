var N=Object.defineProperty;var w=r=>{throw TypeError(r)};var g=(r,e,t)=>e in r?N(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var E=(r,e,t)=>g(r,typeof e!="symbol"?e+"":e,t),A=(r,e,t)=>e.has(r)||w("Cannot "+t);var n=(r,e,t)=>(A(r,e,"read from private field"),t?t.call(r):e.get(r)),u=(r,e,t)=>e.has(r)?w("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),O=(r,e,t,s)=>(A(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const f of a.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();var i;(function(r){r.LOAD="LOAD",r.EXEC="EXEC",r.FFPROBE="FFPROBE",r.WRITE_FILE="WRITE_FILE",r.READ_FILE="READ_FILE",r.DELETE_FILE="DELETE_FILE",r.RENAME="RENAME",r.CREATE_DIR="CREATE_DIR",r.LIST_DIR="LIST_DIR",r.DELETE_DIR="DELETE_DIR",r.ERROR="ERROR",r.DOWNLOAD="DOWNLOAD",r.PROGRESS="PROGRESS",r.LOG="LOG",r.MOUNT="MOUNT",r.UNMOUNT="UNMOUNT"})(i||(i={}));const b=(()=>{let r=0;return()=>r++})(),S=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),y=new Error("called FFmpeg.terminate()");var d,R,l,h,m,I,c;class U{constructor(){u(this,d,null);u(this,R,{});u(this,l,{});u(this,h,[]);u(this,m,[]);E(this,"loaded",!1);u(this,I,()=>{n(this,d)&&(n(this,d).onmessage=({data:{id:e,type:t,data:s}})=>{switch(t){case i.LOAD:this.loaded=!0,n(this,R)[e](s);break;case i.MOUNT:case i.UNMOUNT:case i.EXEC:case i.FFPROBE:case i.WRITE_FILE:case i.READ_FILE:case i.DELETE_FILE:case i.RENAME:case i.CREATE_DIR:case i.LIST_DIR:case i.DELETE_DIR:n(this,R)[e](s);break;case i.LOG:n(this,h).forEach(o=>o(s));break;case i.PROGRESS:n(this,m).forEach(o=>o(s));break;case i.ERROR:n(this,l)[e](s);break}delete n(this,R)[e],delete n(this,l)[e]})});u(this,c,({type:e,data:t},s=[],o)=>n(this,d)?new Promise((a,f)=>{const D=b();n(this,d)&&n(this,d).postMessage({id:D,type:e,data:t},s),n(this,R)[D]=a,n(this,l)[D]=f,o==null||o.addEventListener("abort",()=>{f(new DOMException(`Message # ${D} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(S));E(this,"load",({classWorkerURL:e,...t}={},{signal:s}={})=>(n(this,d)||(O(this,d,e?new Worker(new URL(e,import.meta.url),{type:"module"}):new Worker(new URL("/assets/worker-BAOIWoxA.js",import.meta.url),{type:"module"})),n(this,I).call(this)),n(this,c).call(this,{type:i.LOAD,data:t},void 0,s)));E(this,"exec",(e,t=-1,{signal:s}={})=>n(this,c).call(this,{type:i.EXEC,data:{args:e,timeout:t}},void 0,s));E(this,"ffprobe",(e,t=-1,{signal:s}={})=>n(this,c).call(this,{type:i.FFPROBE,data:{args:e,timeout:t}},void 0,s));E(this,"terminate",()=>{const e=Object.keys(n(this,l));for(const t of e)n(this,l)[t](y),delete n(this,l)[t],delete n(this,R)[t];n(this,d)&&(n(this,d).terminate(),O(this,d,null),this.loaded=!1)});E(this,"writeFile",(e,t,{signal:s}={})=>{const o=[];return t instanceof Uint8Array&&o.push(t.buffer),n(this,c).call(this,{type:i.WRITE_FILE,data:{path:e,data:t}},o,s)});E(this,"mount",(e,t,s)=>{const o=[];return n(this,c).call(this,{type:i.MOUNT,data:{fsType:e,options:t,mountPoint:s}},o)});E(this,"unmount",e=>{const t=[];return n(this,c).call(this,{type:i.UNMOUNT,data:{mountPoint:e}},t)});E(this,"readFile",(e,t="binary",{signal:s}={})=>n(this,c).call(this,{type:i.READ_FILE,data:{path:e,encoding:t}},void 0,s));E(this,"deleteFile",(e,{signal:t}={})=>n(this,c).call(this,{type:i.DELETE_FILE,data:{path:e}},void 0,t));E(this,"rename",(e,t,{signal:s}={})=>n(this,c).call(this,{type:i.RENAME,data:{oldPath:e,newPath:t}},void 0,s));E(this,"createDir",(e,{signal:t}={})=>n(this,c).call(this,{type:i.CREATE_DIR,data:{path:e}},void 0,t));E(this,"listDir",(e,{signal:t}={})=>n(this,c).call(this,{type:i.LIST_DIR,data:{path:e}},void 0,t));E(this,"deleteDir",(e,{signal:t}={})=>n(this,c).call(this,{type:i.DELETE_DIR,data:{path:e}},void 0,t))}on(e,t){e==="log"?n(this,h).push(t):e==="progress"&&n(this,m).push(t)}off(e,t){e==="log"?O(this,h,n(this,h).filter(s=>s!==t)):e==="progress"&&O(this,m,n(this,m).filter(s=>s!==t))}}d=new WeakMap,R=new WeakMap,l=new WeakMap,h=new WeakMap,m=new WeakMap,I=new WeakMap,c=new WeakMap;var _;(function(r){r.MEMFS="MEMFS",r.NODEFS="NODEFS",r.NODERAWFS="NODERAWFS",r.IDBFS="IDBFS",r.WORKERFS="WORKERFS",r.PROXYFS="PROXYFS"})(_||(_={}));const L=new U({log:!0,corePath:"/node_modules/@ffmpeg/core/dist/ffmpeg-core.js"}),p=document.getElementById("status"),C=async()=>{p.textContent="Loading FFmpeg...",await L.load(),p.textContent="FFmpeg ready!"};C();document.getElementById("convertBtn").addEventListener("click",async()=>{const r=document.getElementById("uploader"),e=document.querySelector(".download-link");if(e.href="",e.textContent="",r.files.length===0){alert("Please select a file.");return}const t=r.files[0];p.textContent="Converting...";const o=await(await fetch(URL.createObjectURL(t))).arrayBuffer();await L.writeFile(t.name,new Uint8Array(o)),await L.exec(["-i",t.name,"-b:a","8k","output.mp3"]);const a=await L.readFile("output.mp3"),f=URL.createObjectURL(new Blob([a.buffer],{type:"audio/mpeg"}));e.href=f,e.download="output.mp3",e.textContent="Download converted file",p.textContent="Done!"});
