var N=Object.defineProperty;var A=r=>{throw TypeError(r)};var b=(r,e,t)=>e in r?N(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var E=(r,e,t)=>b(r,typeof e!="symbol"?e+"":e,t),_=(r,e,t)=>e.has(r)||A("Cannot "+t);var n=(r,e,t)=>(_(r,e,"read from private field"),t?t.call(r):e.get(r)),u=(r,e,t)=>e.has(r)?A("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),O=(r,e,t,s)=>(_(r,e,"write to private field"),s?s.call(r,t):e.set(r,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();var o;(function(r){r.LOAD="LOAD",r.EXEC="EXEC",r.FFPROBE="FFPROBE",r.WRITE_FILE="WRITE_FILE",r.READ_FILE="READ_FILE",r.DELETE_FILE="DELETE_FILE",r.RENAME="RENAME",r.CREATE_DIR="CREATE_DIR",r.LIST_DIR="LIST_DIR",r.DELETE_DIR="DELETE_DIR",r.ERROR="ERROR",r.DOWNLOAD="DOWNLOAD",r.PROGRESS="PROGRESS",r.LOG="LOG",r.MOUNT="MOUNT",r.UNMOUNT="UNMOUNT"})(o||(o={}));const g=(()=>{let r=0;return()=>r++})(),y=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),S=new Error("called FFmpeg.terminate()");var c,R,f,h,m,I,d;class U{constructor(){u(this,c,null);u(this,R,{});u(this,f,{});u(this,h,[]);u(this,m,[]);E(this,"loaded",!1);u(this,I,()=>{n(this,c)&&(n(this,c).onmessage=({data:{id:e,type:t,data:s}})=>{switch(t){case o.LOAD:this.loaded=!0,n(this,R)[e](s);break;case o.MOUNT:case o.UNMOUNT:case o.EXEC:case o.FFPROBE:case o.WRITE_FILE:case o.READ_FILE:case o.DELETE_FILE:case o.RENAME:case o.CREATE_DIR:case o.LIST_DIR:case o.DELETE_DIR:n(this,R)[e](s);break;case o.LOG:n(this,h).forEach(i=>i(s));break;case o.PROGRESS:n(this,m).forEach(i=>i(s));break;case o.ERROR:n(this,f)[e](s);break}delete n(this,R)[e],delete n(this,f)[e]})});u(this,d,({type:e,data:t},s=[],i)=>n(this,c)?new Promise((a,l)=>{const D=g();n(this,c)&&n(this,c).postMessage({id:D,type:e,data:t},s),n(this,R)[D]=a,n(this,f)[D]=l,i==null||i.addEventListener("abort",()=>{l(new DOMException(`Message # ${D} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(y));E(this,"load",({classWorkerURL:e,...t}={},{signal:s}={})=>(n(this,c)||(O(this,c,e?new Worker(new URL(e,import.meta.url),{type:"module"}):new Worker(new URL("/assets/worker-BAOIWoxA.js",import.meta.url),{type:"module"})),n(this,I).call(this)),n(this,d).call(this,{type:o.LOAD,data:t},void 0,s)));E(this,"exec",(e,t=-1,{signal:s}={})=>n(this,d).call(this,{type:o.EXEC,data:{args:e,timeout:t}},void 0,s));E(this,"ffprobe",(e,t=-1,{signal:s}={})=>n(this,d).call(this,{type:o.FFPROBE,data:{args:e,timeout:t}},void 0,s));E(this,"terminate",()=>{const e=Object.keys(n(this,f));for(const t of e)n(this,f)[t](S),delete n(this,f)[t],delete n(this,R)[t];n(this,c)&&(n(this,c).terminate(),O(this,c,null),this.loaded=!1)});E(this,"writeFile",(e,t,{signal:s}={})=>{const i=[];return t instanceof Uint8Array&&i.push(t.buffer),n(this,d).call(this,{type:o.WRITE_FILE,data:{path:e,data:t}},i,s)});E(this,"mount",(e,t,s)=>{const i=[];return n(this,d).call(this,{type:o.MOUNT,data:{fsType:e,options:t,mountPoint:s}},i)});E(this,"unmount",e=>{const t=[];return n(this,d).call(this,{type:o.UNMOUNT,data:{mountPoint:e}},t)});E(this,"readFile",(e,t="binary",{signal:s}={})=>n(this,d).call(this,{type:o.READ_FILE,data:{path:e,encoding:t}},void 0,s));E(this,"deleteFile",(e,{signal:t}={})=>n(this,d).call(this,{type:o.DELETE_FILE,data:{path:e}},void 0,t));E(this,"rename",(e,t,{signal:s}={})=>n(this,d).call(this,{type:o.RENAME,data:{oldPath:e,newPath:t}},void 0,s));E(this,"createDir",(e,{signal:t}={})=>n(this,d).call(this,{type:o.CREATE_DIR,data:{path:e}},void 0,t));E(this,"listDir",(e,{signal:t}={})=>n(this,d).call(this,{type:o.LIST_DIR,data:{path:e}},void 0,t));E(this,"deleteDir",(e,{signal:t}={})=>n(this,d).call(this,{type:o.DELETE_DIR,data:{path:e}},void 0,t))}on(e,t){e==="log"?n(this,h).push(t):e==="progress"&&n(this,m).push(t)}off(e,t){e==="log"?O(this,h,n(this,h).filter(s=>s!==t)):e==="progress"&&O(this,m,n(this,m).filter(s=>s!==t))}}c=new WeakMap,R=new WeakMap,f=new WeakMap,h=new WeakMap,m=new WeakMap,I=new WeakMap,d=new WeakMap;var w;(function(r){r.MEMFS="MEMFS",r.NODEFS="NODEFS",r.NODERAWFS="NODERAWFS",r.IDBFS="IDBFS",r.WORKERFS="WORKERFS",r.PROXYFS="PROXYFS"})(w||(w={}));const L=new U({log:!0,corePath:"/node_modules/@ffmpeg/core/dist/ffmpeg-core.js"}),p=document.getElementById("status"),C=async()=>{p.textContent="Loading FFmpeg...",await L.load(),p.textContent="FFmpeg ready!"};C();document.getElementById("convertBtn").addEventListener("click",async()=>{const r=document.getElementById("uploader");if(r.files.length===0){alert("Please select a file.");return}const e=r.files[0];p.textContent="Converting...";const s=await(await fetch(URL.createObjectURL(e))).arrayBuffer();await L.writeFile(e.name,new Uint8Array(s)),await L.exec(["-i",e.name,"-b:a","8k","output.mp3"]);const i=await L.readFile("output.mp3"),a=URL.createObjectURL(new Blob([i.buffer],{type:"audio/mpeg"})),l=document.createElement("a");l.href=a,l.download="output.mp3",l.textContent="Download converted file",document.body.appendChild(l),p.textContent="Done!"});
